<project name="release-jcatapult">
  <target name="rel-javadoc" description="Releases the JCatapult JavaDoc">
    <rel_post/>
  </target>

  <!-- These macrodefs publish the JavaDoc for the release -->
  <macrodef name="rel_post">
    <sequential>
      <property name="docURL" value="https://jcatapult.googlecode.com/svn/jcatapult-javadocs/${project.name}/${project.version}"/>

      <antcall target="javadoc"/>
      <scm_import dir="${dir.target.javadocs}" url="${docURL}" username="${svn.username}" password="${svn.password}"/>

      <delete dir="${dir.target.javadocs}"/>
      <svn username="${svn.username}" password="${svn.password}">
        <checkout url="${docURL}" destPath="${dir.target.javadocs}"/>
      </svn>
      <svn username="${svn.username}" password="${svn.password}">
        <propset path="${dir.target.javadocs}" name="svn:mime-type" value="text/html" recurse="true"/>
      </svn>
      <svn username="${svn.username}" password="${svn.password}">
        <commit dir="${dir.target.javadocs}" message="[JCATAPULT-ANT JavaDoc] Setting mime-type property"/>
      </svn>
    </sequential>
  </macrodef>
</project>
